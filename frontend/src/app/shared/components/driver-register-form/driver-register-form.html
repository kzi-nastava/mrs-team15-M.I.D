<form class="py-5" (ngSubmit)="onSubmit()">

  <div class="position-fixed top-0 end-0 p-3" style="z-index: 1050">
    <div class="toast align-items-center text-white border-0" [class.bg-success]="toastType === 'success'" [class.bg-danger]="toastType === 'error'" [class.show]="showToast" role="alert" aria-live="assertive" aria-atomic="true">
      <div class="d-flex">
        <div class="toast-body">
          {{ toastMessage }}
        </div>
        <button type="button" class="btn-close btn-close-white me-2 m-auto" (click)="showToast = false" aria-label="Close"></button>
      </div>
    </div>
  </div>
  <div class="row g-3">
    <div class="col-md-6">
      <input type="text" class="form-control input-focus" placeholder="First name" [(ngModel)]="user.firstName" name="firstName" [class.is-invalid]="isFieldEmpty(user.firstName)">
      <div class="invalid-feedback d-block" *ngIf="isFieldEmpty(user.firstName)">
        First name is required
      </div>
    </div>
    <div class="col-md-6">
      <input type="text" class="form-control input-focus" placeholder="Last name" [(ngModel)]="user.lastName" name="lastName" [class.is-invalid]="isFieldEmpty(user.lastName)">
      <div class="invalid-feedback d-block" *ngIf="isFieldEmpty(user.lastName)">
        Last name is required
      </div>
    </div>
    <div class="col-md-6">
      <input type="tel" class="form-control input-focus" placeholder="Phone number" [(ngModel)]="user.phone" name="phone" [class.is-invalid]="isFieldEmpty(user.phone) || !isPhoneValid(user.phone)">
      <div class="invalid-feedback d-block" *ngIf="isFieldEmpty(user.phone) || !isPhoneValid(user.phone)">
        {{ getPhoneErrorMessage() }}
      </div>
    </div>
    <div class="col-md-6">
      <input type="text" class="form-control input-focus" placeholder="Address" [(ngModel)]="user.address" name="address" [class.is-invalid]="isFieldEmpty(user.address)">
      <div class="invalid-feedback d-block" *ngIf="isFieldEmpty(user.address)">
        Address is required
      </div>
    </div>
    <div class="col-12">
      <input type="email" class="form-control input-focus" placeholder="Email" [(ngModel)]="user.email" name="email" [class.is-invalid]="isFieldEmpty(user.email) || !isEmailValid(user.email)">
      <div class="invalid-feedback d-block" *ngIf="isFieldEmpty(user.email) || !isEmailValid(user.email)">
        {{ getEmailErrorMessage() }}
      </div>
    </div>

    <!-- Profile Image Upload -->
    <div class="col-12 mt-3">
      <label class="form-label fw-semibold">Profile Image</label>
      <div class="d-flex align-items-center gap-3">
        <input #fileInput type="file" class="d-none" accept="image/*" (change)="onFileSelected($event)">
        <button type="button" class="btn-upload" (click)="onSelectPhoto()">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-upload me-2" viewBox="0 0 16 16">
            <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5"/>
            <path d="M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708z"/>
          </svg>
          Choose Image
        </button>
        <div *ngIf="userAvatar" class="position-relative">
          <img [src]="userAvatar" alt="Profile preview" class="rounded-circle border border-2" style="width: 50px; height: 50px; object-fit: cover;">
          <span class="badge-check position-absolute top-0 start-100 translate-middle">âœ“</span>
        </div>
        <span *ngIf="!userAvatar" class="text-muted small">No image selected</span>
      </div>
    </div>
  </div>

  <div class="vehicle-form mt-2">

      <h3 class="fw-semibold mb-3">Vehicle</h3>

      <div class="row g-2 mb-3">
        <div class="col-12 col-md-6">
             <input type="text"
               class="form-control input-focus"
               placeholder="License plate"
               name="vehicleLicensePlate"
               [(ngModel)]="vehicle.licensePlate"
                [class.is-invalid]="isVehicleFieldEmpty(vehicle.licensePlate) || !isLicensePlateValid(vehicle.licensePlate)" />
                <div class="invalid-feedback d-block" *ngIf="isVehicleFieldEmpty(vehicle.licensePlate) || !isLicensePlateValid(vehicle.licensePlate)">
            {{ getLicensePlateErrorMessage() }}
          </div>
        </div>
        <div class="col-12 col-md-6">
             <input type="text"
               class="form-control input-focus"
               placeholder="Vehicle model"
               name="vehicleModel"
               [(ngModel)]="vehicle.model"
               [class.is-invalid]="isVehicleFieldEmpty(vehicle.model)" />
           <div class="invalid-feedback d-block" *ngIf="isVehicleFieldEmpty(vehicle.model)">
             {{ getModelErrorMessage() }}
           </div>
        </div>
      </div>

      <div class="row g-2 mb-3">
        <div class="col-12 col-md-6">
             <input type="number"
               class="form-control input-focus"
               placeholder="Number of seats"
               name="vehicleSeats"
               [(ngModel)]="vehicle.seats"
               min="1" step="1"
               [class.is-invalid]="vehicle.seats === undefined || vehicle.seats === null || vehicle.seats === '' || vehicle.seats < 1" />
           <div class="invalid-feedback d-block" *ngIf="vehicle.seats === undefined || vehicle.seats === null || vehicle.seats === '' || vehicle.seats < 1">
             {{ getSeatsErrorMessage() }}
           </div>
        </div>
        <div class="col-12 col-md-6">
            <select class="form-select input-focus"
              name="vehicleType"
              [(ngModel)]="vehicle.type"
              [class.is-invalid]="isVehicleFieldEmpty(vehicle.type)">
            <option value="Standard">Standard</option>
            <option value="Luksuz">Luksuz</option>
            <option value="Kombi">Kombi</option>
          </select>
          <div class="invalid-feedback d-block" *ngIf="isVehicleFieldEmpty(vehicle.type)">
            {{ getTypeErrorMessage() }}
          </div>
        </div>
      </div>

      <div class="row g-2 mt-3">
        <div class="col-12 col-md-6">
          <div class="form-check form-switch custom-switch">
            <input class="form-check-input" type="checkbox" name="vehiclePetFriendly" [(ngModel)]="vehicle.petFriendly" id="petFriendly">
            <label class="form-check-label" for="petFriendly">Pet friendly</label>
          </div>
        </div>
        <div class="col-12 col-md-6">
          <div class="form-check form-switch custom-switch">
            <input class="form-check-input" type="checkbox" name="vehicleBabyFriendly" [(ngModel)]="vehicle.babyFriendly" id="babyFriendly">
            <label class="form-check-label" for="babyFriendly">Baby friendly</label>
          </div>
        </div>
      </div>

    </div>

    <div class="form-footer mt-4 d-flex flex-column align-items-center">
      <div class="mt-3"></div>
      <app-button width="450px" height="35px" variant="primary" fontWeight="700" textTransform="uppercase" text="Register New Driver" (clicked)="onSubmit()"></app-button>
      
    </div>

</form>


